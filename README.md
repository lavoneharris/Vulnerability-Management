

<h1>Vulnerability Management Using Nessus Essentials Lab</h1>


<h2> Reference : </h2>
Link: https://www.youtube.com/watch?v=lT6Px9zJM3s
<h2>Description</h2>
This Vulnerability Management Lab consist of using the web platform Nessus Essentials to monitor a Virtual Machine environment on Windows 8 & 10 system and performing both non-credentialed and credentialed vulnerability scans against the Windows 8 & 10 Virtual Machine Host. Once the Vulnerability Assessment is complete on the sandboxed network we will look to use the Vulnerability Management Lifecycle of Discover,Prioritize,Assess,Report,Remediate, and Verify to ensure there are no vulnerabilities by performing suggested Windows Updates.
<br />


<h2>What is Vulnerability Management:</h2>
Vulnerability management is the  practice of identifying, classifying, prioritizing, remediating, and mitigating software vulnerabilities. Vulnerability management is considered an essential part of both computer & network security.
<br />


<h2>Vulnerability Management Lifecycle:</h2>
1. Discover: Inventory all assets across the network and identify host details including operating system and open services to identify vulnerabilities. Develop a network baseline. Identify security vulnerabilities on a regular automated schedule.<br>
<br>
2. Prioritize Assets: Categorize assets into groups or business units, and assign a business value to asset groups based on their criticality to your business operation.<br>
<br>
3. Assess: Determine a baseline risk profile so you can eliminate risks based on asset criticality, vulnerability threat, and asset classification.<br>
<br>
4. Report: Measure the level of business risk associated with your assets according to your security policies. Document a security plan, monitor suspicious activity, and describe known vulnerabilities.<br>
<br>
5. Remediate: Prioritize and fix vulnerabilities in order according to business risk. Establish controls and demonstrate progress.<br>
<br>
6. Verify: Verify that threats have been eliminated through follow-up audits.<br>


<h2>Why Vulnerability Management is Important:</h2>
The purpose of a vulnerability management program is to keep your network safe from known exploitations and ensure it stays compliant with any regulatory requirements. It does this by analyzing your network for any incompatibilities, missed updates and common weaknesses within the software you use. It then prioritizes any vulnerabilities for remediation. A vulnerability management program protects your business network from being breached through well-known vulnerabilities, making it much harder for cybercriminals to target your company.<br>
<br>

<h2>Utilities Used:</h2>
- Oracle Virtual Box <br>
- VMware Workstation 16 Player <br>
- Nessus Essentials<br>
- Windows Command Prompt<br>
- Registry Editor<br>
- Windows Firewall<br>


<h2>Environments Used </h2>

- Windows 10
- Windows 8.1


<h2> General Prerequisites for Lab:</h2>
<p align="center">
Download Windows 10 ISO File from Microsoft: <br/>
<img src="https://imgur.com/tVdXTvW.png" height="80%" width="80%" alt="Download Windows 10 ISO File"/>
<br />
<br />
 <p align="center">
Download Windows 8 ISO File (Note: Going forward when installing the Windows 8 in your VM you will need a Windows 8 Product Key. You can find these Product Keys online but this dangerous and if you have a old pc with Windows 8 with the Product Key I suggest you use that): <br/>
 <img src="https://imgur.com/YqAre4v.png" height="80%" width="80%" alt="Download Windows 10 ISO File"/>
 <img src="https://imgur.com/bbCTklM.png" height="80%" width="80%" alt="Download Windows 10 ISO File"/>
 <img src="https://imgur.com/Y2G3n6R.png" height="80%" width="80%" alt="Download Windows 10 ISO File"/>
 <img src="https://imgur.com/D9xyO0N.png" height="80%" width="80%" alt="Download Windows 10 ISO File"/>
 <img src="https://imgur.com/rtsBMuu.png" height="80%" width="80%" alt="Download Windows 10 ISO File"/>
<br />
<br />
 Download Oracle Virtual Box:  <br/>
<img src="https://imgur.com/uWG2WwF.png" height="80%" width="80%" alt="Download Oracle Virtual Box"/>
<br />
<br />
Download VMware Workstation 16 Player (Note: You will need PC that allows Virtualization. It is also recommended that your PC have 8 GB RAM & at least a Dual Core Processor):  <br/>
<img src="https://imgur.com/4PCy6Wu.png" height="80%" width="80%" alt="Download Oracle Virtual Box"/>
<br />
<br />
Sign Up for Nessus Essentials, you will receive an access code via email to be used later: <br/>
<img src="https://imgur.com/yK9xRHi.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
Once you are provided with the Access Code via email (Make note of it), now DownLoad(Nessus-10.3.0x-64.msi),and Run Nessus: <br/>
 <img src="https://imgur.com/RGZELpy.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
Please note the URL for future reference & now Connect via SSL:
<img src="https://imgur.com/Fpxo2Cq.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
 Select the Advanced button and proceed to LocalHost:
<img src="https://imgur.com/f6rD7TL.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br>
<img src="https://imgur.com/qssyEYY.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
 For Nessus Set Up, Choose Nessus Essentials: <br/>
<img src="https://imgur.com/okIbCFm.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<img src="https://imgur.com/L9gucit.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
 Select the Skip button as the Sign Up portion was already done, then enter the Activation Code from email and select Continue: <br>
<img src="https://imgur.com/E4yY07z.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<img src="https://imgur.com/p0s92fG.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
 Create a username and password you can remember, then select Submit and allow to initialize (this will take some time)<br>
<img src="https://imgur.com/DGF1U2A.png" height="80%" width="80%" alt="Download Nessus Essentials"/>
<br />
<br />
 
 
 
 
 <h2> Vulnerability Management Using Nessus Scanner on Windows 8.1: </h2>
<p align="center">
<h2> Windows 8.1 VM Set Up Walkthrough </h2>
 <p align="center">
1. Open VMware Workstation Player Select Player -> File -> New Virtual Machine <br/>
<img src="https://imgur.com/H82AUSf.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
2. Select Installer disc image (iso) and choose the bit version of Windows 8 you need by browsing to the Windows 8 iso location. (Note: Select this option only if you have the a Windows 8 Product Key. You will always need a Product Key for Windows 8. But the Installer disc image does it all in one install. While the option: I will Install the Operating System later, will do it later as it creates VM with a blank hard disk.) -> Next  <br/>
<img src="https://imgur.com/Goc6HDF.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 3a. Enter the Product Key and give the Windows 8 VM environment a login name and password -> Next
 <img src= "https://imgur.com/OINoOJP.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 4a. Give VM a name -> Next
 <img src= "https://imgur.com/1e0X6Jg.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 5a. Specify Disk Capacity -> Next
  <img src= "https://imgur.com/G0KkxkA.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 6a. Select Customize Hardware
   <img src= "https://imgur.com/aJpYKRY.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 <p align="center">
 7a. Adjust your memory and number of processors to what your actual PC is capable of if -> Close. (If you do not know what your PC is capable of leave as default values)
    <img src= "https://imgur.com/FxWrXpC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
    <img src= "https://imgur.com/a2zOakK.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
  <p align="center">
8a. -> Finish
     <p align="center">
    <img src= "https://imgur.com/FxWrXpC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
  <p align="center">
 3b. If you do not have the Windows 8 Product Key at the moment to use you can just install as a blank hard disk  (You can place the Windows 8 Product Key During the install) Option -> Next
    <img src= "https://imgur.com/RT2mOSt.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 4b. Select Guest Operating System -> Next
  <img src= "https://imgur.com/IwT7IAJ.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 5b. Give VM a name -> Next
 <img src= "https://imgur.com/1e0X6Jg.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 6b. Specify Disk Capacity -> Next
  <img src= "https://imgur.com/G0KkxkA.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 7b. Select Customize Hardware 
   <img src= "https://imgur.com/aJpYKRY.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 8b. Adjust your memory and number of processors to what your actual PC is capable of if -> Close. (If you do not know what your PC is capable of leave as default values)
    <img src= "https://imgur.com/FxWrXpC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
    <img src= "https://imgur.com/a2zOakK.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 9b. -> Finish
   <p align="center">
    <img src= "https://imgur.com/aJpYKRY.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
    <img src= "https://imgur.com/aJpYKRY.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <p align="center">
<br />
<br />
 10. Start the Windows 8 VM and go through the Windows Setup (Use a login name & password you can remember)
    <img src= "https://imgur.com/YVnBL0v.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />
<br />
<br />
 
 
 
 
 
 <h2>Ensure Network Connectivity to the Virtual Machine via your Physical Machine (Windows 8.1 Walkthrough) </h2>
<br />
<br />
<p align="center">
 1. On the VM get the IP Address from Command Prompt by inputing the command ipconfig in the command line:
 <img src= "https://imgur.com/7BoIrrD.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />
  2. Once you have the IP address from the VM. On your physical machine Ping the VM IP address in Command Prompt using the command Ping: 
 <img src= "https://imgur.com/yzXD494.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />
3. Unsuccessful Ping result (we will need to make the connection from NAT to Bridged and disable the VM Firewall):
  <img src= "https://imgur.com/LcgOUY9.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />
4.  Now go to Windows Firewall and go to Advanced Settings-> Firewall Properties and turn off the Firewall state of Domain, Private, and Public profiles and Apply: <br/>
<img src="https://imgur.com/hGAk1yT.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/zjiEBHC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/ytkSpwo.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/59OfksJ.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/BQUcwgy.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 <p align="center">
 5. Set Virtual Machine to use a Bridged Connection in VMware Player 16 Virtual Machine Settings ( This puts the VM on the same network as your Physical Machine):
  <p align="center">
 <img src="https://imgur.com/pg1dS14.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<p align="center">
6. Successful Ping Result:
   <p align="center">
  <img src="https://imgur.com/j3Yg56z.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <p align="center">
<br />
<br />
 
 
 <h1>Create A New Basic Scan In Nessus Windows 8 VM </h1>
 <br />
<br />
<p align="center">
In the Nessus Essentials Home Screen Create a Scan By Selecting the Blue New Scan Button:
 <img src="https://imgur.com/D9AWHGa.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Now Select Basic Network Scan (Note: All the Types of Scans that can be done within Nessus:
 <img src="https://imgur.com/CbTptRB.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Enter the IP address of the VM and give the Scan Job a Name (Please look around the setting tabs as there are tons of options to do things like a Scheduled Scan and Scanning all ports) -> Save:
 <img src="https://imgur.com/2UPPPhK.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="51.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Now Run the Scan Job by clicking the Launch Button:
 <img src="https://imgur.com/jUGXWWC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 If you click on the the Last Modified Time Stamp you can view the progress of the Scan Job:
  <img src="https://imgur.com/IE4G5xk.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/Ak4H3IP.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/kCV1y6O.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/TNvnjs6.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 Now that the Scan is complete, we can see that we have 21 Vulnerabilities found on the VM 1 Medium Importance, 1 High Importance, and 1 Critical Importance (Process/View of some Vulnerabilites Throughout):
  <img src="https://imgur.com/CdLLu1j.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/7wDZp9z.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/8mc3ngI.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/5zKRlJb.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/7bIP4y3.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/x3qjMTn.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/izrjOHE.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/sz0xhEq.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/mG8MDg5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/X9NxqqF.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/InOZt7X.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/gI935qs.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/eaNiGGl.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
  <img src="https://imgur.com/4pwRjGG.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />




 <h1>Create Basic Scan in Nessus with Credentials (This will allow Nessus Scanner to into the VM more deeply to scan for vulnerabilities) </h1>
 <br />
<br />
 <p align="center">
We will need to Setup our Windows 8 VM to be able to accept Authenticated Scans
 <br />
<br />
<p align="center">
1. Go to Services on the Window 8 VM and enable Remote Registry by clicking Properites -> Start Type: Automatic -> OK :
<img src="https://imgur.com/A0r7fMg.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/NrMMZc8.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
2. Enable File and Printer Sharing:
<img src="https://imgur.com/sMjniyg.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
3. Set User Account Controls to Never Notify:
<img src="https://imgur.com/RBDYkv9.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
4. Go to Registry Editor by using the Windows Button + R and entering regedit -> OK:
<img src="https://imgur.com/Dhyd1CA.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
5. In Registry Editor go to the Directory Computer\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\POLICIES\SYSTEM:
<img src="https://imgur.com/i7Xt50E.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
6. Right Click -> New DWORD 32 BIT Value and name it "LocalAccountTokenFilterPolicy":
<img src="https://imgur.com/nJfvjRN.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/qJEwSSU.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
7. Left click on LocalAccountTokenFilterPolicy and select Modify and change the Value from 0 to 1
<img src="https://imgur.com/GCHg6v5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
8. Reboot the Windows 8 VM:
<img src="https://imgur.com/bUAf0zH.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
9. Once, that is complete go to your original Nessus Scanner Job and check mark the Job and go to More -> Configure:
 <img src="https://imgur.com/xibuViz.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
10. Go the Credentials Tab -> Windows and enter your VM credentials -> SAVE:
<img src="https://imgur.com/2UPPPhK.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/jFKuLj2.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 <p align="center">
11. Run the Scan Job again:
  <p align="center">
<img src="https://imgur.com/jUGXWWC.png.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
   <p align="center">
12. Note that this time the scan ran and we now have a total of 26 Vulnerabilities Most Important According to the VPR5 Top Threats are 1 Critical and 3 Medium:
    <p align="center">
<img src="https://imgur.com/2bfWMwS.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/Dv8YYEB.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/GQYPTrd.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/mv0pSDE.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />


<h2> Final Scan with a Deprecated Version of Mozilla Firefox Installed on the Windows 8 VM </h2>
 <p align="center">
1. In your VM search with a web browser for an Old Version of Firefox. Download a outdated version of Firefox the example is from October of 2015. URL:https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US (IMPORTANT: MAKE SURE YOU GET THE OLD VERSION OF FIREFOX FROM MOZILLA AS THE PICTURE AS ANYWHERE ELSE COULD BE DANGEROUS):
  <p align="center">
<img src="https://imgur.com/ojt3rim.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
2. Run the Installer for FireFox: 
<img src="https://imgur.com/rcQSynW.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
3. Go Back to the Nessus Scanner and Run once more: 
<img src="https://imgur.com/jUGXWWC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
4. In running the Scan, we see the scanner picked up no new vulnerabilities as the total remained at 26. This could be a cause for concern or maybe the vulnerabilities were addressed by Firefox. 
<img src="https://imgur.com/pojOfXh.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<h2> Remediation Windows 8 VM </h2>
 <p align="center">
To remediate these Windows 8 Vulnerabilities should be quite simple, as most of the suggestions from Nesus for the vulnerabilities was to update our Windows 8 machine via patches. As you see since this is a fresh install of Windows 8 there is a laundry list of Updates (Important, Recommended, and Optional) that should be applied once that is complete the list if vulnerabilities discovered by Nessus will decrease. You can check this by rerunning the scan.
<img src="https://imgur.com/wfX1jds.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/CcF9SUC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/XLTKTHZ.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/NydRVEF.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/soFDFLy.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/t9eLAuI.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/nYfLkzW.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/Jy9fx7d.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />







 
 
 
 
 
 
 
 
 
 
 
 
  <h2> Vulnerability Management Using Nessus Scanner on Windows 10: </h2>
<p align="center">
<h2> Windows 10 VM Set Up Walkthrough </h2>
 <p align="center">
 1. Open Oracle Virtual Box by selecting the New icon: <br/>
<img src="171.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
  2. In the create Virtul Machine Screen give VM a Name, adjust memory size(if necessary/capable), and Create a Virtual Hard Disk now -> Create: <br/>
<img src="173.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 3. Choose File Location for Windows 10 VM and choose Hard Disk Type VDI. Adjust File Size (if necessary/capable):<br/>
<img src="37.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
4. Start the Windows 10 VM by selecting the Start Icon. In the select start-up disk page, choose the folder icon and choose the folder icon and selct the add icon and select the Windows 10 .ISO File -> Start:  <br/>
 <img src="172.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/zT8JEzu.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="174.png" height="80%" width="80%" alt="Disk Sanitization Steps"/> 
<img src="https://imgur.com/179mrD6.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="175.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 5. Go through the Windows Setup, make sure the version of Windows installed is Windows 10 PRO (Use a login name & password you can remember)
    <img src="69.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
    <img src= ".png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 
 
 
 
 
 
  <h2>Ensure Network Connectivity to the Virtual Machine via your Physical Machine (Windows 10 Walkthrough) </h2>
<br />
<br />
<p align="center">
 1. On the VM get the IP Address from Command Prompt by inputing the command ipconfig in the command line:
 <br />
<br />
  2. Once you have the IP address from the VM. On your physical machine Ping the VM IP address in Command Prompt using the command Ping: 
 <br />
<br />
3. Unsuccessful Ping result (we will need to make the connection from NAT to Bridged and disable the VM Firewall):
  <img src= "46.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />
4.  Now go to Windows Firewall with Advanced Security -> Windows Defender Firewall Properties and turn off the Firewall state of Domain, Private, and Public profiles and Apply: <br/>
<img src="176.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/zjiEBHC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/ytkSpwo.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/59OfksJ.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="https://imgur.com/BQUcwgy.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 <p align="center">
 5. Set Virtual Machine to use a Bridged Connection in Oracle Virtual Box by going to Machine -> Settings -> Network and switching from NAT to Bridged Adpater (This puts the VM on the same network as your Physical Machine):
  <p align="center">
 <img src="https://imgur.com/pg1dS14.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<p align="center">
6. Successful Ping Result:
   <p align="center">
  <img src="47.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <p align="center">
<br />
<br />
 
 
 
 
 
 <h1>Create A New Basic Scan In Nessus Windows 10 VM  </h1>
 <br />
<br />
<p align="center">
In the Nessus Essentials Home Screen Create a Scan By Selecting the Blue New Scan Button:
 <img src="48.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Now Select Basic Network Scan (Note: All the Types of Scans that can be done within Nessus:
 <img src="https://imgur.com/CbTptRB.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Enter the IP address of the VM and give the Scan Job a Name (Please look around the setting tabs as there are tons of options to do things like a Scheduled Scan and Scanning all ports) -> Save:
 <img src="50.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <img src="51.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
Now Run the Scan Job by clicking the Launch Button:
 <img src="54.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 If you click on the the Last Modified Time Stamp you can view the progress of the Scan Job:
  <img src="55.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 Now that the Scan is complete, we can see that we have 0 Vulnerabilities found on the VM.):
  <img src="56.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
 <br />
<br />

 
 
 
 
  <h1>Create Basic Scan in Nessus with Credentials With Windows 10 VM (This will allow Nessus Scanner to into the VM more deeply to scan for vulnerabilities) </h1>
 <br />
<br />
 <p align="center">
We will need to Setup our Windows 10 VM to be able to accept Authenticated Scans
 <br />
<br />
<p align="center">
1. Go to Services on the Window 10 VM and enable Remote Registry by clicking Properites -> Start Type: Automatic -> OK :
<img src="179.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="76.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
2. Enable File and Printer Sharing by going to Advanced Sharing Settings:
<img src="180.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
3. Set User Account Controls to Never Notify:
<img src="77.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
4. Go to Registry Editor:
<img src="75.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
5. In Registry Editor go to the Directory Computer\HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\POLICIES\SYSTEM:
<img src="78.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
6. Right Click -> New DWORD 32 BIT Value and name it "LocalAccountTokenFilterPolicy":
<img src="https://imgur.com/nJfvjRN.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://imgur.com/qJEwSSU.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
7. Left click on LocalAccountTokenFilterPolicy and select Modify and change the Value from 0 to 1
<img src="79.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
8. Reboot the Windows 10 VM:
<img src="181.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
9. Once, that is complete go to your original Nessus Scanner Job and check mark the Job and go to More -> Configure:
 <img src="57.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
10. Go the Credentials Tab -> Windows and enter your VM credentials -> SAVE:
<img src="58.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
 <p align="center">
11. Run the Scan Job again:
  <p align="center">
<img src="59.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
   <p align="center">
12. Note that this time the scan ran and we now have a total of 13 Vulnerabilities 1 Medium:
    <p align="center">
<img src="60.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="61.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="62.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="63.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
     
     
     
     
     
  <h2> Final Scan with a Deprecated Version of Mozilla Firefox Installed on the Windows 10 VM </h2>
 <p align="center">
1. In your VM search with a web browser for an old Version of Firefox. Download a outdated version of Firefox the example is from October of 2015 URL:https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US.(IMPORTANT: MAKE SURE YOU GET THE OLD VERSION OF FIREFOX FROM MOZILLA AS THE PICTURE AS ANYWHERE ELSE COULD BE DANGEROUS):
  <p align="center">
<img src="182.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
2. Run the Installer for FireFox: 
<img src="183.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
3. Go Back to the Nessus Scanner and Run once more: 
<img src="59.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
4. In running the Scan, we see the scanner picked up no new vulnerabilities as the total remained at 13. This could be a cause for concern or maybe the vulnerabilities were addressed by Firefox. 
<img src="61.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
   
   
   
   
   
<h2> Remediation Windows 10 VM </h2>
 <p align="center">
To remediate these Windows 10 Vulnerabilities should be quite simple, as most of the suggestions from Nesus for the vulnerabilities was to update our Windows 10 machine via patches. As you see since this is updated install of Windows 10 there is not laundry list of updates that can be applied but once an update is complete the list if vulnerabilities discovered by Nessus may decrease. You can check this by rerunning the scan.
<img src="https://imgur.com/1kHga2z.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>

<br />
<br />   
<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
